"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9864],{2808:function(oe,I,e){e.d(I,{Z:function(){return m}});var T=e(97857),_=e.n(T),x=e(62370),h=e(51663),Z=e(67294),c=e(85893);function m(d){return(0,c.jsx)(x.Z,_()(_()({},d),{},{children:(0,c.jsx)(h.Z,{showText:function(B){return B.toHexString()},allowClear:!0,presets:[{label:"Color",colors:["#1677ff","#722ed1","#13c2c2","#52c41a","#eb2f96","#f5222d","#fa8c16","#fadb14","#fa541c","#2f54eb","#faad14","#a0d911","#000000","#5cdbd3","#b37feb","#b7eb8f","#61affe","#9254de","#36cfc9","#ff9c6e","#ff6f00","#ffc069","#28a745","#6610f2","#6f42c1","#007bff","#17a2b8","#20c997","#00cccc","#ff6666"]}]})}))}},85184:function(oe,I,e){e.d(I,{Z:function(){return Me}});var T=e(15009),_=e.n(T),x=e(99289),h=e.n(x),Z=e(5574),c=e.n(Z),m=e(87662),d=e(67294),w=e(27166),B=e(55681),ie=e(83622),A=e(23345),ue=e(25593),de=e(86250),M=e(84567),_e=e(71230),z=e(15746),$=e(2487),ce=e(83062),fe=e(96074),me=e(38345),Ee=e(97269),N=e(62370),he=e(12122),pe=e(87740),ve=e(23430),Pe=e(3616),V=e(64389),E=e(36146),S=e(5251),H=e(80821),De=e(24963),Oe=e(4813),a=e(85893);function Me(){var p=new E.Uo("components.systemBasic"),ge=(0,d.useContext)(De.Z),G=ge.message,Ce=(0,d.useState)([]),J=c()(Ce,2),v=J[0],Q=J[1],Ue=(0,d.useState)(0),X=c()(Ue,2),P=X[0],Y=X[1],Re=(0,d.useState)(0),k=c()(Re,2),g=k[0],q=k[1],je=(0,d.useState)(0),ee=c()(je,2),D=ee[0],C=ee[1],Ie=(0,d.useState)(!1),te=c()(Ie,2),b=te[0],Te=te[1],xe=(0,d.useState)("panel"),ae=c()(xe,2),Be=ae[0],ne=ae[1],Ae=(0,d.useState)([]),re=c()(Ae,2),se=re[0],L=re[1],W=(0,d.useRef)(),O=(0,d.useRef)(),U=(0,d.useRef)(null),K=v.reduce(function(n,t){return n+t.used},0),y=P>0&&P>=g,R=y&&Be==="disk"?"disk":"panel",le=R==="disk"?P:g;return(0,d.useEffect)(function(){b&&(0,m.PW)().then(function(n){n&&n.data&&(n.data.pathUsage&&(Q(n.data.pathUsage),L(n.data.pathUsage.filter(function(t){return!["export/panel","temp","dpanel"].includes(t.name)}).map(function(t){return t.value}))),n.data.diskUsage&&Y(n.data.diskUsage),n.data.panelUsage&&q(n.data.panelUsage))})},[D,b]),(0,d.useEffect)(function(){if(!(!U.current||v.length===0)){var n=V.JE(U.current)||V.S1(U.current),t=function(r,u){var f=v.map(function(j){return{value:j.used,name:p.format("panelUsage.".concat(j.name)),usedSize:j.usedSize||"0B",percent:r>0?(j.used/r*100).toFixed(4):"0.00"}});if(r>K){var F=r-K;f.push({value:F,name:u,usedSize:(0,S.FI)(F),percent:(F/r*100).toFixed(4)})}return f},l=["\u9762\u677F\u89C6\u89D2"],s=[{name:"\u9762\u677F\u89C6\u89D2",type:"pie",radius:"80%",center:["55%","55%"],data:t(g,"\u5176\u4ED6\u9762\u677F\u6570\u636E"),emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{formatter:function(r){return"".concat(r.name,`
{size|`).concat(r.data.usedSize,"}")},rich:{size:{color:"#888",fontSize:12,lineHeight:18}}}}];y&&(l.push("\u786C\u76D8\u89C6\u89D2"),s.push({name:"\u786C\u76D8\u89C6\u89D2",type:"pie",radius:"50%",center:["55%","55%"],data:t(P,"\u5176\u4ED6\u786C\u76D8\u7A7A\u95F4"),emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{formatter:function(r){return"".concat(r.name,`
{size|`).concat(r.data.usedSize,"}")},rich:{size:{color:"#888",fontSize:12,lineHeight:18}}}})),n.setOption({tooltip:{trigger:"item",formatter:function(r){return"".concat(r.marker," <b>").concat(r.name,"</b><br/>\u5B9E\u9645\u5927\u5C0F: ").concat(r.data.usedSize,"<br/>\u89C6\u53E3\u5360\u6BD4: ").concat(r.data.percent,"%")}},legend:{orient:"vertical",top:"0",left:"1%",selectedMode:"single",data:l,selected:{\u9762\u677F\u89C6\u89D2:R==="panel",\u786C\u76D8\u89C6\u89D2:R==="disk"}},series:s},!0),n.off("legendselectchanged"),n.on("legendselectchanged",function(o){var r=Object.keys(o.selected).find(function(u){return o.selected[u]});ne(r==="\u786C\u76D8\u89C6\u89D2"?"disk":"panel")});var i=function(){return n==null?void 0:n.resize()};return window.addEventListener("resize",i),function(){return window.removeEventListener("resize",i)}}},[v,P,g,y,R,K]),(0,a.jsxs)(w.Z,{open:b,drawerProps:{width:Pe.R_,destroyOnHidden:!0},onOpenChange:function(t){t||(Q([]),Y(0),q(0),ne("panel"),L([])),Te(t)},title:"\u7528\u91CF\u4E0E\u5907\u4EFD",trigger:(0,a.jsx)(ie.ZP,{style:{width:150},children:"\u7528\u91CF\u4E0E\u5907\u4EFD"}),children:[(0,a.jsx)(me.Z,{title:(0,a.jsxs)(A.Z,{children:[(0,a.jsx)(he.Z,{}),(0,a.jsx)("span",{children:"\u7528\u91CF\u7EDF\u8BA1"})]}),bordered:!0,headerBordered:!0,extra:(0,a.jsxs)(A.Z,{children:[(0,a.jsx)(H.Z,{buttonProps:{type:"primary"},action:h()(_()().mark(function n(){var t;return _()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,m.wC)({backupPath:se});case 2:G.success(E.FD.format("finish")),C(D+1),!((t=W.current)===null||t===void 0)&&t.reloadAndRest&&W.current.reloadAndRest();case 5:case"end":return s.stop()}},n)})),children:"\u5F00\u59CB\u5907\u4EFD"}),(0,a.jsx)(H.Z,{buttonProps:{danger:!0,style:{width:150}},action:h()(_()().mark(function n(){var t,l;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,m.$D)({enableNotice:(t=O.current)===null||t===void 0?void 0:t.getFieldValue("enableNotice"),enableTempFile:(l=O.current)===null||l===void 0?void 0:l.getFieldValue("enableTempFile")});case 2:G.success(E.FD.format("finish")),C(D+1);case 4:case"end":return i.stop()}},n)})),confirmProps:{onOpenChange:function(t,l){var s;t&&(!((s=O.current)===null||s===void 0)&&s.resetFields)&&O.current.resetFields()},description:(0,a.jsxs)(A.Z,{style:{minWidth:300},direction:"vertical",wrap:!0,children:[(0,a.jsx)(ue.Z.Text,{children:p.format("panelUsagePruneTip")}),(0,a.jsx)(Ee.A,{name:"createForm",formRef:O,layout:"inline",submitter:!1,children:(0,a.jsxs)(de.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,{initialValue:!0,name:"enableTempFile",valuePropName:"checked",children:(0,a.jsx)(M.Z,{children:p.format("panelUsagePruneEnableTempFile")})}),(0,a.jsx)(N.Z,{initialValue:!0,name:"enableNotice",valuePropName:"checked",children:(0,a.jsx)(M.Z,{defaultChecked:!0,children:p.format("panelUsagePruneEnableNotice")})})]})})]})},children:p.format("panelUsagePruneButton")})]}),children:(0,a.jsxs)(_e.Z,{gutter:24,align:"middle",children:[(0,a.jsx)(z.Z,{span:12,children:v.length>0&&(0,a.jsx)("div",{ref:U,style:{height:320,width:"100%"}})}),(0,a.jsx)(z.Z,{span:12,children:(0,a.jsx)(M.Z.Group,{style:{width:"100%"},value:se,onChange:function(t){return L(t)},children:(0,a.jsx)($.Z,{grid:{gutter:30,column:2},dataSource:v,renderItem:function(t){return(0,a.jsx)($.Z.Item,{children:(0,a.jsxs)(M.Z,{value:t.value,style:{width:"100%"},children:[(0,a.jsx)("span",{style:{fontWeight:"500",width:"90px",display:"inline-block"},children:(0,a.jsx)(ce.Z,{title:t.value,placement:"left",children:p.format("panelUsage."+t.name)})}),(0,a.jsxs)("span",{style:{color:"#1677ff"},children:[t.usedSize," / ",le>0?(t.used/le*100).toFixed(2):"0.00","%"]})]})})}})})})]})},"usage"),(0,a.jsx)(fe.Z,{variant:"dotted"}),(0,a.jsx)(B.Co,{ghost:!0,actionRef:W,search:!1,rowKey:"path",actions:[{key:"upload",label:"\u4E0A\u4F20\u5907\u4EFD\u6587\u4EF6",showInQuickToolbar:!0,buttonProps:{type:"primary"}},{key:"restore",label:E.FD.format("listManageUnpause"),showInOperator:!0,showInContext:"manage",buttonProps:{icon:(0,a.jsx)(pe.Z,{})}},{key:"download",label:E.FD.format("listManageDownload"),showInOperator:!0,showInContext:"manage",buttonProps:{icon:(0,a.jsx)(ve.Z,{})},action:function(t){return h()(_()().mark(function l(){var s,i,o,r;return _()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=t.loading,i=t.finish,o=t.selectedRow,s(),f.next=4,(0,m.w4)({name:o.path}).finally(function(){i(!0)});case 4:r=f.sent,r.data.downloadUrl&&(0,Oe.u)({url:r.data.downloadUrl});case 6:case"end":return f.stop()}},l)}))()}},{key:"delete",showInContext:!0,action:function(t){return h()(_()().mark(function l(){var s,i,o;return _()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=t.loading,i=t.finish,o=t.selectedRows,s(),u.abrupt("return",(0,m.Ug)({name:o.map(function(f){return f.path})}).finally(function(){i(!0),C(D+1)}));case 3:case"end":return u.stop()}},l)}))()}}],columns:[{title:E.FD.format("listFilePath"),dataIndex:"path"},{title:E.FD.format("listSize"),dataIndex:"size",render:function(t,l,s,i){return(0,S.FI)(l.size)}},{title:E.FD.format("listCreatedAt"),dataIndex:"createdAt",render:function(t,l,s,i){return(0,S.NF)(l.createdAt)}}],request:function(){var n=h()(_()().mark(function t(l,s,i){var o;return _()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,m.ip)().finally(function(){C(D+1)});case 2:return o=u.sent,u.abrupt("return",{data:o.data.list,success:!0,total:o.data.list.length});case 4:case"end":return u.stop()}},t)}));return function(t,l,s){return n.apply(this,arguments)}}()},"backupFileList")]})}}}]);
