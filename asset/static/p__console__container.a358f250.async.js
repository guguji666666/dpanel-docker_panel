(self.webpackChunk=self.webpackChunk||[]).push([[9969],{49610:function(w,p,t){"use strict";var i=t(5574),n=t.n(i),M=t(12323),u=t(52626),l=t(87662),g=t(78267),m=t.n(g),O=t(4244),y=t.n(O),C=t(24078),f=t(67294),b=t(85893),a,E,s,D,v=(0,f.forwardRef)(function(W,I){var S,A=(0,f.useState)(),K=n()(A,2),R=K[0],r=K[1],o=(0,f.useState)(""),_=n()(o,2),e=_[0],j=_[1];function L(){D&&(a.reset(),E.fit(),a.focus(),D.dispose()),s&&(s.close(),s=null)}return(0,f.useImperativeHandle)(I,function(){return{start:function(c,d){L(),E.fit(),d.width=a.cols,d.height=a.rows;var T=d?Object.keys(d).filter(function(P){return d&&d[P]}).map(function(P){return d&&d[P]?"".concat(P,"=").concat(d[P]):""}):[];s=new WebSocket((0,u.R)(c+"?"+T.join("&"))),s.addEventListener("message",function(P){var B=JSON.parse(P.data),U=B.type;if(U===c&&(a.write(B.data),B.data.indexOf("exec failed")!==-1)){L();return}}),D=a.onData(function(P){var B={content:{command:P},type:c};s&&s.send(JSON.stringify(B))}),j(c),r(d)},close:function(){L()},fit:function(){return E.fit(),{width:a.cols,height:a.rows}},run:function(c){R&&(c==null||c.forEach(function(d){var T={content:{command:d+`
`},type:e};s&&s.send(JSON.stringify(T))}))}}}),(0,f.useEffect)(function(){return a=new O.Terminal(M.X),E=new g.FitAddon,a.loadAddon(E),a.open(document.getElementById("terminal-container-console")),E.fit(),a.onKey(function(h){var c=h.domEvent;if(c.ctrlKey&&c.key==="c"){var d=a.getSelection();if(d){navigator.clipboard.writeText(d).then(function(){a.clearSelection()}),c.preventDefault();return}}c.ctrlKey&&c.key==="v"&&(navigator.clipboard.readText().then(function(T){T&&a.input(T)}),c.preventDefault())}),(0,l.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(h){h.data&&h.data.fontSize&&Object.assign(a.options,h.data)}),function(){L()}},[]),(0,f.useEffect)(function(){window.addEventListener("resize",function(){E.fit();var h={size:{width:a.cols,height:a.rows},type:e};e&&s&&s.send(JSON.stringify(h))})},[e]),(0,b.jsx)("div",{style:{height:(S=W.height)!==null&&S!==void 0?S:"100vh"},id:"terminal-container-console"})});p.Z=v},12323:function(w,p,t){"use strict";t.d(p,{X:function(){return i},n:function(){return n}});var i={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},n=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},15563:function(w,p,t){"use strict";t.r(p),t.d(p,{default:function(){return y}});var i=t(5574),n=t.n(i),M=t(49610),u=t(13822),l=t(5251),g=t(63713),m=t(67294),O=t(85893);function y(){var C=(0,g.useParams)(),f=(0,g.useSearchParams)(),b=n()(f,2),a=b[0],E=b[1],s=(0,m.useRef)();return(0,m.useEffect)(function(){C.id&&(0,u.jV)({md5:C.id}).then(function(D){var v;window.document.title="".concat((0,l.fi)(D.data.info.Name,"/")," - console"),C.id&&((v=s.current)===null||v===void 0||v.start("/console/container/".concat(D.data.info.Id),{cmd:a.get("cmd"),workDir:a.get("workDir")}))}),document.body.style.overflow="hidden"},[]),(0,O.jsx)(M.Z,{ref:s})}},13822:function(w,p,t){"use strict";t.d(p,{IE:function(){return O},IW:function(){return g},KK:function(){return E},LJ:function(){return D},RF:function(){return S},Re:function(){return W},aF:function(){return K},eE:function(){return b},jV:function(){return C}});var i=t(15009),n=t.n(i),M=t(99289),u=t.n(M),l=t(63713);function g(r){return m.apply(this,arguments)}function m(){return m=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/status",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),m.apply(this,arguments)}function O(r){return y.apply(this,arguments)}function y(){return y=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/get-list",{data:o,method:"POST"}));case 1:case"end":return e.stop()}},r)})),y.apply(this,arguments)}function C(r){return f.apply(this,arguments)}function f(){return f=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/get-detail",{data:o,method:"POST"}));case 1:case"end":return e.stop()}},r)})),f.apply(this,arguments)}function b(r){return a.apply(this,arguments)}function a(){return a=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/update",{data:o,method:"POST"}));case 1:case"end":return e.stop()}},r)})),a.apply(this,arguments)}function E(){return s.apply(this,arguments)}function s(){return s=u()(n()().mark(function r(){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,l.request)("/dpanel/api/app/container/prune",{method:"POST"}));case 1:case"end":return _.stop()}},r)})),s.apply(this,arguments)}function D(r){return v.apply(this,arguments)}function v(){return v=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/export",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),v.apply(this,arguments)}function W(r){return I.apply(this,arguments)}function I(){return I=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/commit",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),I.apply(this,arguments)}function S(r){return A.apply(this,arguments)}function A(){return A=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/upgrade",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),A.apply(this,arguments)}function K(r){return R.apply(this,arguments)}function R(){return R=u()(n()().mark(function r(o){return n()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/dpanel/api/app/container/copy",{method:"POST",data:o}));case 1:case"end":return e.stop()}},r)})),R.apply(this,arguments)}},24078:function(){"use strict"},78267:function(w){(function(p,t){w.exports=t()})(self,()=>(()=>{"use strict";var p={};return(()=>{var t=p;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=class{activate(i){this._terminal=i}dispose(){}fit(){const i=this.proposeDimensions();if(!i||!this._terminal||isNaN(i.cols)||isNaN(i.rows))return;const n=this._terminal._core;this._terminal.rows===i.rows&&this._terminal.cols===i.cols||(n._renderService.clear(),this._terminal.resize(i.cols,i.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const i=this._terminal._core,n=i._renderService.dimensions;if(n.css.cell.width===0||n.css.cell.height===0)return;const M=this._terminal.options.scrollback===0?0:i.viewport.scrollBarWidth,u=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(u.getPropertyValue("height")),g=Math.max(0,parseInt(u.getPropertyValue("width"))),m=window.getComputedStyle(this._terminal.element),O=l-(parseInt(m.getPropertyValue("padding-top"))+parseInt(m.getPropertyValue("padding-bottom"))),y=g-(parseInt(m.getPropertyValue("padding-right"))+parseInt(m.getPropertyValue("padding-left")))-M;return{cols:Math.max(2,Math.floor(y/n.css.cell.width)),rows:Math.max(1,Math.floor(O/n.css.cell.height))}}}})(),p})())}}]);
